{
  "summary": "Added a comprehensive README.md documenting the lifesim emergent-life sandbox, including CLI quick start, full flag reference, examples (headless, ASCII render, checkpoint save/resume), Python API overview, default ruleset behavior, determinism, and checkpointing notes.",
  "writes": [
    {
      "base_sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
      "content": "# lifesim\n\n`lifesim` is a small, deterministic emergent-life sandbox on a toroidal grid. Agents move, gain/spend energy, reproduce into adjacent empty cells, and die from starvation or old age. You can run simulations from the CLI to print per-tick metrics (CSV), optionally render the world as ASCII, and save/load checkpoints to resume runs.\n\n## Quick start (CLI)\n\nRun a basic headless simulation and print CSV metrics:\n\n```bash\nlifesim --width 40 --height 20 --seed 123 --steps 100\n```\n\nRender each step as ASCII:\n\n```bash\nlifesim --width 20 --height 10 --seed 123 --steps 30 --render ascii\n```\n\nPrint version:\n\n```bash\nlifesim --version\n```\n\n## CLI reference\n\nThe CLI entrypoint is `lifesim` (see `lifesim/cli.py`).\n\n### Required arguments\n\n- `--width INT` \u2014 World width in cells.\n- `--height INT` \u2014 World height in cells.\n- `--seed INT` \u2014 Random seed.\n- `--steps INT` \u2014 Number of steps to run.\n\n### Optional simulation arguments\n\n- `--density FLOAT` \u2014 Initial agent density (0.0-1.0). Default: `0.3`.\n- `--initial-energy INT` \u2014 Initial energy per agent. Default: `10`.\n- `--energy-gain INT` \u2014 Energy gained per step. Default: `2`.\n- `--move-cost INT` \u2014 Energy cost per move. Default: `1`.\n- `--reproduction-threshold INT` \u2014 Energy threshold to reproduce. Default: `15`.\n- `--reproduction-cost INT` \u2014 Energy cost to reproduce (also child's starting energy). Default: `8`.\n- `--max-age INT` \u2014 Maximum age before death. Default: `50`.\n\n### Rendering\n\n- `--render {ascii,none}` \u2014 Render mode. Default: `none`.\n\n### Checkpointing\n\n- `--checkpoint-out PATH` \u2014 Optional path to save final world state as a checkpoint.\n- `--checkpoint-in PATH` \u2014 Optional path to load initial world state from a checkpoint.\n\nNotes:\n- The CLI always prints metrics as CSV to stdout at the end of the run.\n- When `--render ascii` is enabled, the ASCII grid is printed each step (followed by a blank line), and the CSV is printed after the simulation completes.\n\n## CLI examples\n\n### 1) Headless run (metrics only)\n\n```bash\nlifesim --width 60 --height 30 --seed 42 --steps 200 --render none\n```\n\nThis prints CSV like:\n\n```\nstep_number,population,births,deaths,avg_energy\n...\n```\n\n### 2) ASCII render run\n\n```bash\nlifesim --width 25 --height 12 --seed 7 --steps 50 --render ascii\n```\n\nASCII legend (from `lifesim/render.py`):\n- `.` empty cell\n- `@` agent with energy > 5\n- `o` agent with energy 1\u20135\n- `x` agent with energy <= 0\n\n### 3) Checkpoint save and resume\n\nSave the final state after 100 steps:\n\n```bash\nlifesim --width 40 --height 20 --seed 123 --steps 100 --checkpoint-out run_100.json\n```\n\nResume from that checkpoint (you must still provide `--width/--height/--seed/--steps` because they are required CLI args; the world state itself is loaded from the checkpoint):\n\n```bash\nlifesim --width 40 --height 20 --seed 123 --steps 50 --checkpoint-in run_100.json --checkpoint-out run_150.json\n```\n\n## Python API overview\n\nCore types live in `lifesim/types.py`. The main building blocks are:\n\n- `lifesim.world.create_world(config) -> World`\n- `World.step() -> StepResult`\n- `StatsCollector` for per-tick metrics and CSV export\n- `render_ascii(state) -> str` for ASCII visualization\n- `save_checkpoint(state, path)` / `load_checkpoint(path) -> WorldState`\n\nExample:\n\n```python\nfrom lifesim.types import SimConfig\nfrom lifesim.world import World, create_world\nfrom lifesim.stats import StatsCollector\nfrom lifesim.render import render_ascii\nfrom lifesim.checkpoint import save_checkpoint, load_checkpoint\n\nconfig = SimConfig(width=20, height=10, seed=123, max_steps=100)\nworld = create_world(config)\n\nstats = StatsCollector()\n\nfor _ in range(10):\n    step_result = world.step()\n    stats.record(step_result)\n    print(render_ascii(step_result.world))\n    print()\n\nprint(stats.to_csv())\n\n# Save a checkpoint of the current world state\nsave_checkpoint(world.get_state(), \"checkpoint.json\")\n\n# Resume later\nstate = load_checkpoint(\"checkpoint.json\")\nworld2 = World(config=config, state=state)\nstep_result = world2.step()\n```\n\n## Default ruleset (what agents do)\n\nThe default rules are implemented in `lifesim/rules.py` (`default_ruleset`). In broad strokes:\n\n- **World topology:** the grid wraps toroidally (moving off an edge wraps around).\n- **Per-step processing order:** agents are processed in sorted position order for determinism.\n- **Movement:** each agent attempts to move one cell in its current direction (N/E/S/W). Collisions are prevented so that no two agents occupy the same cell.\n- **Direction update:** after movement, each agent\u2019s direction is randomized (0\u20133) using the step RNG.\n- **Energy update:** each step applies `energy = energy - move_cost + energy_gain`.\n- **Reproduction:** if an agent\u2019s energy is at least `reproduction_threshold`, it may place a child into a randomly chosen adjacent empty cell (N/E/S/W). The child starts with `reproduction_cost` energy, and the parent loses `reproduction_cost` energy.\n- **Death:** agents die if `energy <= 0` or if `age > max_age`.\n\n## Determinism\n\nSimulations are deterministic given the same configuration and seed:\n\n- World initialization uses `seed`.\n- Each step uses a deterministic per-step RNG derived from `seed` and the current `step_number` (see `World.step()`), which makes runs reproducible and supports resuming from checkpoints.\n\nAs a result, the same seed + config produces identical step-by-step results.\n\n## Checkpointing\n\nCheckpoints are JSON files containing a serialized `WorldState` (width, height, step number, seed, and the full agent list).\n\n- Save from Python with `save_checkpoint(world.get_state(), path)`.\n- Load with `state = load_checkpoint(path)` and resume by constructing `World(config=config, state=state)`.\n\nFrom the CLI:\n- `--checkpoint-out PATH` saves the final world state after the run.\n- `--checkpoint-in PATH` loads the initial world state from a checkpoint before stepping.\n",
      "path": "README.md"
    }
  ]
}
