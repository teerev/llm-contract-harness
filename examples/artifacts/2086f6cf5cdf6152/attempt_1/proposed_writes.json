{
  "summary": "Implemented tests for PNG rendering correctness and determinism in tests/test_render.py.",
  "writes": [
    {
      "base_sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
      "content": "import os\nimport tempfile\nimport filecmp\nfrom lsysviz.render import render_to_png\nfrom lsysviz.types import Segment\nfrom PIL import Image\n\n\ndef test_render_non_empty_segments_creates_valid_png():\n    segments = [Segment(0, 0, 1, 1)]\n    width, height = 100, 100\n    with tempfile.TemporaryDirectory() as tmpdirname:\n        output_path = os.path.join(tmpdirname, 'output.png')\n        render_to_png(segments=segments, width=width, height=height, output_path=output_path)\n        assert os.path.exists(output_path)\n        with open(output_path, 'rb') as f:\n            assert f.read(8) == b'\\x89PNG\\r\\n\\x1a\\n'\n\n\ndef test_render_empty_segments_creates_blank_image():\n    segments = []\n    width, height = 100, 100\n    with tempfile.TemporaryDirectory() as tmpdirname:\n        output_path = os.path.join(tmpdirname, 'output.png')\n        render_to_png(segments=segments, width=width, height=height, output_path=output_path)\n        assert os.path.exists(output_path)\n        image = Image.open(output_path)\n        assert image.size == (width, height)\n        assert image.getpixel((0, 0)) == (255, 255, 255)\n\n\ndef test_render_determinism():\n    segments = [Segment(0, 0, 1, 1)]\n    width, height = 100, 100\n    with tempfile.TemporaryDirectory() as tmpdirname:\n        output_path1 = os.path.join(tmpdirname, 'output1.png')\n        output_path2 = os.path.join(tmpdirname, 'output2.png')\n        render_to_png(segments=segments, width=width, height=height, output_path=output_path1)\n        render_to_png(segments=segments, width=width, height=height, output_path=output_path2)\n        assert filecmp.cmp(output_path1, output_path2, shallow=False)\n\n\ndef test_render_segments_with_negative_coordinates():\n    segments = [Segment(-1, -1, 1, 1)]\n    width, height = 100, 100\n    with tempfile.TemporaryDirectory() as tmpdirname:\n        output_path = os.path.join(tmpdirname, 'output.png')\n        render_to_png(segments=segments, width=width, height=height, output_path=output_path)\n        assert os.path.exists(output_path)\n        image = Image.open(output_path)\n        assert image.size == (width, height)\n",
      "path": "tests/test_render.py"
    }
  ]
}
