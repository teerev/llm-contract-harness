{
  "summary": "Add deterministic unit tests for lsysviz.turtle.interpret using the correct parameter names and verifying segment geometry, turn direction, stack push/pop behavior, and ignoring unknown characters.",
  "writes": [
    {
      "base_sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
      "content": "import pytest\n\nfrom lsysviz.turtle import interpret\nfrom lsysviz.types import Segment\n\n\nTOL = 1e-9\n\n\ndef _pt(x, y):\n    return (pytest.approx(x, abs=TOL), pytest.approx(y, abs=TOL))\n\n\ndef _seg(a, b):\n    return Segment(_pt(*a), _pt(*b))\n\n\ndef test_single_F_angle_90_step_10_produces_one_segment_up():\n    # interpret uses parameter names: turn_angle, step_size\n    segs = interpret(\"F\", turn_angle=90, step_size=10)\n    assert len(segs) == 1\n    assert segs[0] == _seg((0.0, 0.0), (0.0, 10.0))\n\n\ndef test_FF_produces_two_segments():\n    segs = interpret(\"FF\", turn_angle=90, step_size=10)\n    assert len(segs) == 2\n    assert segs[0] == _seg((0.0, 0.0), (0.0, 10.0))\n    assert segs[1] == _seg((0.0, 10.0), (0.0, 20.0))\n\n\ndef test_F_plus_F_angle_90_second_segment_goes_left():\n    # Default heading is +Y; '+' turns left (CCW), so after one F and a +90 turn,\n    # the next F should go toward -X.\n    segs = interpret(\"F+F\", turn_angle=90, step_size=10)\n    assert len(segs) == 2\n    assert segs[0] == _seg((0.0, 0.0), (0.0, 10.0))\n    assert segs[1] == _seg((0.0, 10.0), (-10.0, 10.0))\n\n\ndef test_F_minus_F_angle_90_second_segment_goes_right():\n    # '-' turns right (CW), so after one F and a -90 turn, the next F should go toward +X.\n    segs = interpret(\"F-F\", turn_angle=90, step_size=10)\n    assert len(segs) == 2\n    assert segs[0] == _seg((0.0, 0.0), (0.0, 10.0))\n    assert segs[1] == _seg((0.0, 10.0), (10.0, 10.0))\n\n\ndef test_push_pop_F_bracket_plus_F_bracket_minus_F_third_starts_after_first():\n    # Sequence:\n    # F: (0,0)->(0,10)\n    # [: push state at (0,10)\n    # +F: turn left and draw to (-10,10)\n    # ]: pop back to (0,10) with original heading\n    # -F: turn right and draw to (10,10)\n    segs = interpret(\"F[+F]-F\", turn_angle=90, step_size=10)\n    assert len(segs) == 3\n\n    assert segs[0] == _seg((0.0, 0.0), (0.0, 10.0))\n    assert segs[1] == _seg((0.0, 10.0), (-10.0, 10.0))\n\n    # Third segment must start from the position after the first F (0,10), not after the second.\n    assert segs[2] == _seg((0.0, 10.0), (10.0, 10.0))\n\n\ndef test_unknown_characters_are_ignored_FXF_produces_two_segments():\n    segs = interpret(\"FXF\", turn_angle=90, step_size=10)\n    assert len(segs) == 2\n    assert segs[0] == _seg((0.0, 0.0), (0.0, 10.0))\n    assert segs[1] == _seg((0.0, 10.0), (0.0, 20.0))\n",
      "path": "tests/test_turtle.py"
    }
  ]
}
