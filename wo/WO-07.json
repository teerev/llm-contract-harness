{
  "id": "WO-07",
  "title": "WO-07: Turtle interpreter v2 (stack + move)",
  "intent": "Extend the turtle interpreter to support branching via a state stack and a non-drawing forward move command.",
  "allowed_files": [
    "lsysviz/turtle.py"
  ],
  "forbidden": [
    "Do not modify files outside allowed_files.",
    "Do not add new dependencies.",
    "Do not implement rasterization, PNG encoding, render pipeline wiring, or CLI changes in this step.",
    "Keep the diff small and incremental relative to WO-06 (do not rewrite the whole file)."
  ],
  "acceptance_commands": [
    "bash scripts/verify.sh",
    "python -c \"from lsysviz.turtle import to_segments; segs = to_segments('F[+F]F', angle_degrees=90, step=1); assert len(segs) == 3\"",
    "python -c \"from lsysviz.turtle import to_segments; segs = to_segments('fF', angle_degrees=90, step=1); assert len(segs) == 1\""
  ],
  "context_files": [
    "lsysviz/turtle.py"
  ],
  "notes": "Type: additive-feature. Contracts (frozen): add these command semantics on top of WO-06 without changing existing ones: 'f' moves forward by step without drawing; '[' pushes the current state (x,y,heading_degrees) onto a stack; ']' pops the state (error if stack underflows). All behavior must be deterministic. Compositionality: branching is added as a monotone extension; downstream stages (raster/PNG/render) consume the same segment format."
}

