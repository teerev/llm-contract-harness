{
  "id": "WO-12",
  "title": "WO-12: Render pipeline v1 (Spec -> PNG bytes)",
  "intent": "Implement the minimal deterministic render_png_bytes pipeline that expands, interprets, fits, rasterizes, and encodes a PNG.",
  "allowed_files": [
    "lsysviz/render.py"
  ],
  "forbidden": [
    "Do not modify files outside allowed_files.",
    "Do not add new dependencies.",
    "Do not change the frozen CLI flags or the frozen spec schema in this step.",
    "Keep the diff small and incremental relative to WO-11 (do not rewrite fit_segments_to_canvas)."
  ],
  "acceptance_commands": [
    "bash scripts/verify.sh",
    "python -c \"from lsysviz.spec import parse_spec; from lsysviz.render import render_png_bytes; s=parse_spec({'axiom':'F','rules':{'F':'F+F'},'iterations':1,'angle_degrees':90,'step':5,'width':32,'height':32}); b1=render_png_bytes(s); b2=render_png_bytes(s); assert b1==b2 and b1[:8]==b'\\x89PNG\\r\\n\\x1a\\n'\""
  ],
  "context_files": [
    "lsysviz/render.py"
  ],
  "notes": "Type: additive-feature. Contracts (frozen): render_png_bytes(spec)->bytes returns PNG bytes deterministically for the same Spec input. It must compose existing modules only: lsysviz.expand.expand, lsysviz.turtle.to_segments, fit_segments_to_canvas, lsysviz.raster.draw_segments, and lsysviz.png.encode_png. Use a fixed line color (black) and background color (white) for now (colors are out of scope). Compositionality: end-to-end behavior is introduced by composing already-frozen lower-level contracts."
}
