{
  "id": "WO-03",
  "title": "WO-03: Spec parser v1 (strict, minimal)",
  "intent": "Create a minimal, strict JSON spec parser for the required L-system fields that rejects unknown keys.",
  "allowed_files": [
    "lsysviz/spec.py"
  ],
  "forbidden": [
    "Do not modify files outside allowed_files.",
    "Do not add new dependencies.",
    "Do not implement L-system expansion, turtle interpretation, rasterization, PNG encoding, or CLI changes in this step.",
    "Do not introduce optional keys in this step (defer optional/defaulted fields like margin and RGBA to a later work order).",
    "Keep lsysviz/spec.py small and boring (aim for <= 80 lines; no long docstrings).",
    "Patch correctness requirement: ensure the unified diff is complete and directly applyable by git apply; hunk header line counts must match the actual added/removed lines (do not output truncated patches)."
  ],
  "acceptance_commands": [
    "bash scripts/verify.sh",
    "python -c \"from lsysviz.spec import parse_spec; s=parse_spec({'axiom':'F','rules':{'F':'FF'},'iterations':1,'angle_degrees':90,'step':10,'width':32,'height':32}); assert s is not None and s.axiom=='F' and s.width==32\"",
    "python -c \"from lsysviz.spec import parse_spec; ok=False\ntry:\n  parse_spec({'axiom':'F','rules':{'F':'FF'},'iterations':1,'angle_degrees':90,'step':10,'width':32,'height':32,'extra':1})\nexcept Exception:\n  ok=True\nassert ok\""
  ],
  "context_files": [],
  "notes": "Type: contract-definition. Contracts (frozen): The input spec is JSON with exactly these required keys: axiom (string), rules (object), iterations (int), angle_degrees (number), step (number), width (int), height (int). Unknown keys must be rejected. Validation in this v1 work order must be strict but minimal: (1) spec root is a dict, (2) required keys present, (3) unknown keys rejected, (4) axiom is str, (5) rules is dict, (6) iterations is int and >= 0 (reject bool), (7) width/height are int and > 0 (reject bool), (8) angle_degrees/step are numbers (reject bool) and step > 0. On success, parse_spec must return a Spec dataclass instance (never None). Defer optional/defaulted fields (margin, colors, line_width, start_heading_degrees) and deeper rules validation to a later hardening work order."
}

