{
  "system_overview": [
    "Python package `hangman` with separate modules for state (`state.py`), word selection (`words.py`), game logic (`logic.py`), and CLI (`cli.py`).",
    "CLI entrypoint via `python -m hangman` calls `hangman.cli.main()`; no external dependencies beyond standard library and pytest.",
    "Tests live under `tests/` and focus on guess handling plus win/loss detection."
  ],
  "verify_contract": {
    "command": "python -m pytest -q",
    "requires": [
      {
        "kind": "file_exists",
        "path": "scripts/verify.sh"
      },
      {
        "kind": "file_exists",
        "path": "tests/test_placeholder.py"
      }
    ]
  },
  "work_orders": [
    {
      "id": "WO-01",
      "title": "Bootstrap verify script",
      "intent": "Create scripts/verify.sh as the global verification command.",
      "preconditions": [
        {
          "kind": "file_absent",
          "path": "scripts/verify.sh"
        }
      ],
      "postconditions": [
        {
          "kind": "file_exists",
          "path": "scripts/verify.sh"
        }
      ],
      "allowed_files": [
        "scripts/verify.sh"
      ],
      "forbidden": [
        "Do not create any other files."
      ],
      "acceptance_commands": [
        "python -c \"import os; assert os.path.isfile('scripts/verify.sh')\""
      ],
      "context_files": [
        "scripts/verify.sh"
      ],
      "notes": "scripts/verify.sh must contain exactly three lines (no extra whitespace):\n1) #!/usr/bin/env bash\n2) set -euo pipefail\n3) python -m pytest -q",
      "verify_exempt": true
    },
    {
      "id": "WO-02",
      "title": "Create package skeleton and placeholder test",
      "intent": "Establish the hangman package root and a minimal pytest test file.",
      "preconditions": [
        {
          "kind": "file_absent",
          "path": "hangman/__init__.py"
        },
        {
          "kind": "file_absent",
          "path": "tests/test_placeholder.py"
        }
      ],
      "postconditions": [
        {
          "kind": "file_exists",
          "path": "hangman/__init__.py"
        },
        {
          "kind": "file_exists",
          "path": "tests/test_placeholder.py"
        }
      ],
      "allowed_files": [
        "hangman/__init__.py",
        "tests/test_placeholder.py"
      ],
      "forbidden": [
        "Do not add any other modules or tests yet."
      ],
      "acceptance_commands": [
        "python -c \"import os; assert os.path.isfile('hangman/__init__.py'); assert os.path.isfile('tests/test_placeholder.py'); import hangman\""
      ],
      "context_files": [
        "hangman/__init__.py",
        "tests/test_placeholder.py"
      ],
      "notes": "Keep hangman/__init__.py minimal (e.g., a short module docstring). tests/test_placeholder.py should define a single test that always passes.",
      "verify_exempt": false
    },
    {
      "id": "WO-03",
      "title": "Add game state data model",
      "intent": "Provide a GameState dataclass that holds the core mutable state of a game.",
      "preconditions": [
        {
          "kind": "file_absent",
          "path": "hangman/state.py"
        }
      ],
      "postconditions": [
        {
          "kind": "file_exists",
          "path": "hangman/state.py"
        }
      ],
      "allowed_files": [
        "hangman/state.py"
      ],
      "forbidden": [
        "Do not add logic functions or word lists in this step."
      ],
      "acceptance_commands": [
        "python -c \"from hangman.state import GameState; s=GameState('test',6); assert s.secret_word=='test' and s.max_incorrect==6 and s.guessed_letters==set() and s.incorrect_guesses==0\""
      ],
      "context_files": [
        "hangman/state.py"
      ],
      "notes": "Define GameState as a dataclass with fields: secret_word (str), max_incorrect (int), guessed_letters (set[str], default empty), incorrect_guesses (int, default 0). Keep it data-only.",
      "verify_exempt": false
    },
    {
      "id": "WO-04",
      "title": "Add built-in word list and selection",
      "intent": "Provide a fixed built-in word list and a function to choose a word.",
      "preconditions": [
        {
          "kind": "file_absent",
          "path": "hangman/words.py"
        }
      ],
      "postconditions": [
        {
          "kind": "file_exists",
          "path": "hangman/words.py"
        }
      ],
      "allowed_files": [
        "hangman/words.py"
      ],
      "forbidden": [
        "Do not add any game logic or CLI wiring."
      ],
      "acceptance_commands": [
        "python -c \"from hangman.words import WORD_LIST, choose_word; assert isinstance(WORD_LIST,list) and len(WORD_LIST)>0; w=choose_word(); assert w in WORD_LIST\""
      ],
      "context_files": [
        "hangman/words.py"
      ],
      "notes": "WORD_LIST should be a small hard-coded list of lowercase words (e.g., 5-10 items). choose_word() should return a single item from WORD_LIST, optionally using random.choice.",
      "verify_exempt": false
    },
    {
      "id": "WO-05",
      "title": "Implement core guess-processing logic",
      "intent": "Provide masking, guess application, and win/loss detection functions operating on GameState.",
      "preconditions": [
        {
          "kind": "file_absent",
          "path": "hangman/logic.py"
        }
      ],
      "postconditions": [
        {
          "kind": "file_exists",
          "path": "hangman/logic.py"
        }
      ],
      "allowed_files": [
        "hangman/logic.py"
      ],
      "forbidden": [
        "Do not modify state.py or words.py in this step."
      ],
      "acceptance_commands": [
        "python -c \"from hangman.state import GameState; from hangman.logic import apply_guess, mask_word, is_won, is_lost; s=GameState('cat',3); s=apply_guess(s,'c'); assert s.guessed_letters=={'c'} and s.incorrect_guesses==0; assert mask_word(s.secret_word,s.guessed_letters)=='c__'; s=apply_guess(s,'x'); assert s.incorrect_guesses==1; assert not is_won(s) and not is_lost(s)\""
      ],
      "context_files": [
        "hangman/logic.py",
        "hangman/state.py"
      ],
      "notes": "Implement functions: mask_word(secret_word, guessed_letters) -> str with '_' for unguessed letters; apply_guess(state, guess) -> GameState that returns a new state (do not mutate input); is_won(state) -> bool (all letters guessed); is_lost(state) -> bool (incorrect_guesses >= max_incorrect). apply_guess should normalize guess to lowercase, require a single alphabetic character (raise ValueError otherwise), and not penalize repeated guesses.",
      "verify_exempt": false
    },
    {
      "id": "WO-06",
      "title": "Add CLI game loop entrypoint",
      "intent": "Provide a terminal game loop callable via hangman.cli.main and python -m hangman.",
      "preconditions": [
        {
          "kind": "file_absent",
          "path": "hangman/cli.py"
        },
        {
          "kind": "file_absent",
          "path": "hangman/__main__.py"
        }
      ],
      "postconditions": [
        {
          "kind": "file_exists",
          "path": "hangman/cli.py"
        },
        {
          "kind": "file_exists",
          "path": "hangman/__main__.py"
        }
      ],
      "allowed_files": [
        "hangman/cli.py",
        "hangman/__main__.py"
      ],
      "forbidden": [
        "Do not change existing logic or tests."
      ],
      "acceptance_commands": [
        "python -c \"from hangman import cli; assert hasattr(cli,'main') and callable(cli.main); import hangman.__main__ as m; assert hasattr(m,'main') and callable(m.main)\""
      ],
      "context_files": [
        "hangman/cli.py",
        "hangman/__main__.py",
        "hangman/words.py",
        "hangman/logic.py",
        "hangman/state.py"
      ],
      "notes": "Implement a simple input/print loop: choose a word, create initial GameState, repeatedly show masked word and guessed letters, prompt for a single-letter guess, apply_guess, and exit when is_won or is_lost. main() should return an int exit code (0). __main__.py should call cli.main() via SystemExit.",
      "verify_exempt": false
    },
    {
      "id": "WO-07",
      "title": "Add tests for guess handling and win/loss detection",
      "intent": "Add pytest coverage for core guess processing and win/loss detection rules.",
      "preconditions": [
        {
          "kind": "file_absent",
          "path": "tests/test_logic.py"
        }
      ],
      "postconditions": [
        {
          "kind": "file_exists",
          "path": "tests/test_logic.py"
        }
      ],
      "allowed_files": [
        "tests/test_logic.py"
      ],
      "forbidden": [
        "Do not modify application modules or existing tests."
      ],
      "acceptance_commands": [
        "python -m pytest -q tests/test_logic.py"
      ],
      "context_files": [
        "tests/test_logic.py",
        "hangman/logic.py",
        "hangman/state.py"
      ],
      "notes": "Write tests that cover: correct guesses reveal letters, incorrect guesses increment incorrect_guesses, repeated guesses do not increment, is_won returns True when all letters guessed, is_lost returns True when incorrect_guesses >= max_incorrect.",
      "verify_exempt": false
    }
  ]
}
