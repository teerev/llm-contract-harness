{
  "id": "WO-05",
  "title": "Implement core guess-processing logic",
  "intent": "Provide masking, guess application, and win/loss detection functions operating on GameState.",
  "preconditions": [
    {
      "kind": "file_absent",
      "path": "hangman/logic.py"
    }
  ],
  "postconditions": [
    {
      "kind": "file_exists",
      "path": "hangman/logic.py"
    }
  ],
  "allowed_files": [
    "hangman/logic.py"
  ],
  "forbidden": [
    "Do not modify state.py or words.py in this step."
  ],
  "acceptance_commands": [
    "python -c \"from hangman.state import GameState; from hangman.logic import apply_guess, mask_word, is_won, is_lost; s=GameState('cat',3); s=apply_guess(s,'c'); assert s.guessed_letters=={'c'} and s.incorrect_guesses==0; assert mask_word(s.secret_word,s.guessed_letters)=='c__'; s=apply_guess(s,'x'); assert s.incorrect_guesses==1; assert not is_won(s) and not is_lost(s)\""
  ],
  "context_files": [
    "hangman/logic.py",
    "hangman/state.py"
  ],
  "notes": "Implement functions: mask_word(secret_word, guessed_letters) -> str with '_' for unguessed letters; apply_guess(state, guess) -> GameState that returns a new state (do not mutate input); is_won(state) -> bool (all letters guessed); is_lost(state) -> bool (incorrect_guesses >= max_incorrect). apply_guess should normalize guess to lowercase, require a single alphabetic character (raise ValueError otherwise), and not penalize repeated guesses.",
  "verify_exempt": false
}
